<?php  
if (!defined('BASEPATH')) exit('No direct script access allowed');

class MY_Controller extends CI_Controller {
    var $yo;
    var $client;

    function __construct(){

        parent::__construct();
        
        //TRAE LOS DATOS DE CONFIGURACION
        //$this->yo=$this->m_usuarios->getRegistros(getUserId());
    } 

    function set_client($redirectUri){
        require_once (APPPATH.'vendor/autoload.php');
        $this->client = new Google_Client();
        $this->client->setClientId(GOOGLE_OAUTH_CLIENT_ID);
        $this->client->setClientSecret(GOOGLE_OAUTH_CLIENT_SECRET);
        $this->client->setRedirectUri($redirectUri);
        $this->client->addScope('email','profile');
    }
    
    /**
     * Carga una vista, agregándole encabezado, barras
     * y pie de página
     * @param string $vista el nombre de la vista
     * @param array $data parámetros a pasar a la vista (opcional)
     */
    function cargaVistaDecorada($vista, $data=array()){
        $sedes = $this->sedes_model->get('nombre');
        $menuSedes = new Menu('SEDES');
        $menuSEDE = new MenuItem('Sedes', 'fa fa-university');
        
        foreach($sedes as $sede){
            $menuSEDE->agregaItem(new MenuItem($sede['nombre'], '', BASEURL.'sede/'.$sede['codSede']));
        }

        $menuSedes->agregaItem($menuSEDE);

        /* Agrega menú de gestión para la sede activa.
         * Si no hay sede activa, no se muestra el menú.
         */
        $sedeNombre = $this->session->sedeNombre;
        if($sedeNombre){
            $menuGestion = new Menu("SEDE $sedeNombre");
                $menuGP = new MenuItem('Gesti&oacute;n de personas', 'fa fa-user');
                $menuGP->agregaItem(new MenuItem('ABM', '', BASEURL.'persona'));
                $menuGP->agregaItem(new MenuItem('Asociaci&oacute;n de cursos', '', '#'));
            $menuGestion->agregaItem($menuGP);
            $data['menuGestion'] = $menuGestion;
        }
        $menuGeneral = new Menu('MENU GENERAL');
        $menuGeneral->agregaItem(new MenuItem('Tablero', 'fa fa-dashboard', BASEURL.'tablero'));
            $menuC = new MenuItem('Configuraci&oacute;n', 'fa fa-gear');
            $menuU = new MenuItem('Usuarios', '', '#');
                $menuU->agregaItem(new MenuItem('Nivel 3','fa fa-dashboard', 'fin'));
            $menuC->agregaItem(new MenuItem('Usuarios', '', '#'));
            $menuC->agregaItem($menuU);
        $menuGeneral->agregaItem($menuC);
        
        $data['menuSedes'] = $menuSedes;
        $data['menuGeneral'] = $menuGeneral;
            
        $this->load->view("template/header");
        $this->load->view("template/main_sidebar", $data);
        if(isset($data)){
            $this->load->view($vista, $data);
        }else{
            $this->load->view($vista);
        }
        $this->load->view("template/footer");
        $this->load->view("template/control_sidebar");
        $this->load->view("template/end");
    }
}

////FIN